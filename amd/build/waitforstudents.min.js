define("quizaccess_tcquiz/waitforstudents",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;
/**
   * Wait for the students to connect to tcquiz session.
   * Redisplay the number of connected students every POLLING_INTERVAL miliiseconds
   *
   * @module     quizaccess_tcquiz
   * @copyright  2024 Capilano University
   * @author     Tamara Dakic <tdakic@capilanou.ca>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
const Selectors={actions:{nextButton:'[data-action="quizaccess_tcquiz/waitforstudents-next_button"]'},regions:{numStudentsSpan:'[data-region="quizaccess_tcquiz/numberstudents_span"]'}},registerEventListeners=(sessionid,quizid,cmid,attemptid,POLLING_INTERVAL)=>{var updateNumStudentsEvent=setInterval((async()=>{await async function(sessionid,quizid,cmid,attemptid){var result=await fetch(M.cfg.wwwroot+"/mod/quiz/accessrule/tcquiz/quizdatateacher.php?requesttype=getnumberstudents&quizid="+quizid+"&sessionid="+sessionid+"&cmid="+cmid+"&attempt="+attemptid+"&currentquestion=0&sesskey="+M.cfg.sesskey,{method:"POST"}),response_xml_text=await result.text();await function(response_xml_text){var response_xml=(new DOMParser).parseFromString(response_xml_text,"text/html"),number_of_students=response_xml.getElementsByTagName("tcquiz").item(0).getElementsByTagName("numberstudents").item(0).textContent;document.querySelector(Selectors.regions.numStudentsSpan).innerHTML=number_of_students}(response_xml_text)}(sessionid,quizid,cmid,attemptid)}),POLLING_INTERVAL);document.querySelector(Selectors.actions.nextButton).addEventListener("click",(async e=>{e.preventDefault(),clearInterval(updateNumStudentsEvent),updateNumStudentsEvent=null;var result=await fetch(M.cfg.wwwroot+"/mod/quiz/accessrule/tcquiz/quizdatateacher.php?requesttype=getquestion&quizid="+quizid+"&cmid="+cmid+"&attempt="+attemptid+"&sessionid="+sessionid+"&rejoin=0&sesskey="+M.cfg.sesskey,{method:"POST"}),response_xml_text=await result.text();await function(response_xml_text){var response_xml=(new DOMParser).parseFromString(response_xml_text,"text/html"),next_url=response_xml.getElementsByTagName("tcquiz").item(0).getElementsByTagName("url").item(0).textContent;window.location.replace(next_url)}(response_xml_text)}),{once:!0})};_exports.init=(sessionid,quizid,cmid,attemptid,POLLING_INTERVAL)=>{registerEventListeners(sessionid,quizid,cmid,attemptid,POLLING_INTERVAL)}}));

//# sourceMappingURL=waitforstudents.min.js.map