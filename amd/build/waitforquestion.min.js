define("quizaccess_tcquiz/waitforquestion",["exports","core/notification","core/str"],(function(_exports,_notification,_str){var obj;
/**
   * Redirects a student to the current quiz page. Used when the student
   * joins the quiz.
   *
   * @module     quizaccess_tcquiz
   * @copyright  2024 Capilano University
   * @author     Tamara Dakic <tdakic@capilanou.ca>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_notification=(obj=_notification)&&obj.__esModule?obj:{default:obj};const registerEventListeners=(sessionid,quizid,cmid,attemptid,POLLING_INTERVAL)=>{window.goToCurrentQuizPageEvent=setInterval((async()=>{await async function(sessionid,quizid,cmid,attemptid){var result=await fetch(M.cfg.wwwroot+"/mod/quiz/accessrule/tcquiz/quizdatastudent.php?quizid="+quizid+"&sessionid="+sessionid+"&cmid="+cmid+"&attempt="+attemptid+"&sesskey="+M.cfg.sesskey,{method:"POST"}),response_xml_text=await result.text();await function(response_xml_text){const response_xml=(new DOMParser).parseFromString(response_xml_text,"text/html");var quizresponse=response_xml.getElementsByTagName("tcquiz").item(0);if(null===quizresponse)return void _notification.default.addNotification({message:(0,_str.get_string)("invalidserverresponse","quizaccess_tcquiz"),type:"error"});var quizstatus=quizresponse.getElementsByTagName("status").item(0).textContent;if("showquestion"==quizstatus){window.goToCurrentQuizPageEvent=null,clearInterval(window.goToCurrentQuizPageEvent);var attempt_url=quizresponse.getElementsByTagName("url").item(0).textContent;window.location.replace(attempt_url)}else if("showresults"==quizstatus){window.goToCurrentQuizPageEvent=null,clearInterval(window.goToCurrentQuizPageEvent);var result_url=quizresponse.getElementsByTagName("url").item(0).textContent;window.location.replace(result_url)}else if("finalresults"==quizstatus){window.goToCurrentQuizPageEvent=null,clearInterval(window.goToCurrentQuizPageEvent);result_url=quizresponse.getElementsByTagName("url").item(0).textContent;window.location.replace(result_url)}else if("quiznotrunning"==quizstatus||"waitforquestion"==quizstatus||"waitforresults"==quizstatus||"noaction"==quizstatus);else if("error"==quizstatus){var errmsg=quizresponse.getElementsByTagName("message").item(0).textContent;_notification.default.addNotification({message:errmsg,type:"error"})}else _notification.default.addNotification({message:(0,_str.get_string)("unknownserverresponse","quizaccess_tcquiz")+quizstatus,type:"error"})}(response_xml_text)}(sessionid,quizid,cmid,attemptid)}),POLLING_INTERVAL)};_exports.init=(sessionid,quizid,cmid,attemptid,POLLING_INTERVAL)=>{registerEventListeners(sessionid,quizid,cmid,attemptid,POLLING_INTERVAL)}}));

//# sourceMappingURL=waitforquestion.min.js.map